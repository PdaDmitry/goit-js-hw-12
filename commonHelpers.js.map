{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport class ImageServer {\n  #pageSize = 15;\n\n  constructor() {\n    this.KEY = '42263617-81d7156b9f7b88cd7b1016c2a';\n    this.URL = 'https://pixabay.com';\n    this.resources = '/api/';\n  }\n\n  async getImages(value, currentPage) {\n    const params = {\n      key: this.KEY,\n      q: value,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: this.#pageSize,\n      page: currentPage,\n    };\n\n    const url = `${this.URL}${this.resources}`;\n\n    try {\n      const response = await axios.get(url, { params });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response.status);\n    }\n  }\n\n  get pageSize() {\n    return this.#pageSize;\n  }\n}\n","export function createGalleryMarkup() {\n  return `\n  <div class=\"container\">\n   <form class=\"form\">\n    <input class=\"input\" type=\"text\" name=\"picture\" placeholder=\"Search images...\" />\n    <button class=\"btn-search\" type=\"submit\">Search</button>\n  </form>\n  <span class=\"loader is-hidden\">Loading images, please wait...</span>\n  <ul class=\"gallery\"></ul>\n  <div class=\"cont-load\">\n  <button class=\"btn-load btn-search is-hidden\" type=\"button\">Load more</button>\n  <span class=\"loader second-load is-hidden\" data-loader>Loading images, please wait...</span>\n  </div>\n  </div>`;\n}\n\nexport function renderListGallery(images) {\n  const item = images\n    .map(el => {\n      const {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = el;\n      return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      data-source=\"${largeImageURL}\"\n      alt=\"\"\n      title=\"${tags}\"\n    />\n    <ul class=\"image-info\">\n      <li class=\"info-item\">\n        <span class=\"info-item\">Likes</span>\n        <span class=\"item-quantity\">${likes}</span>\n      </li>\n       <li class=\"info-item\">\n        <span class=\"info-item\">Views</span>\n        <span class=\"item-quantity\">${views}</span>\n      </li>\n       <li class=\"info-item\">\n        <span class=\"info-item\">Comments</span>\n        <span class=\"item-quantity\">${comments}</span>\n      </li>\n       <li class=\"info-item\">\n        <span class=\"info-item\">Downloads</span>\n        <span class=\"item-quantity\">${downloads}</span>\n      </li>\n    </ul>\n  </a>\n  </li>`;\n    })\n    .join('\\n\\n');\n\n  return item;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { ImageServer } from './js/pixabay-api';\nimport { createGalleryMarkup, renderListGallery } from './js/render-functions';\n\nconst galleryMarkup = createGalleryMarkup();\n\nconst body = document.querySelector('body');\nbody.insertAdjacentHTML('afterbegin', galleryMarkup);\n\nconst formEl = document.querySelector('form');\nconst loader = document.querySelector('.loader');\nconst loaderSecond = document.querySelector('[data-loader]');\n\nconst gallery = document.querySelector('.gallery');\nconst input = document.querySelector('input');\nconst button = document.querySelector('button');\nconst btnLoad = document.querySelector('.btn-load');\n\nconst images = new ImageServer();\nconst show = new SimpleLightbox('.gallery a');\n\nfunction showIziToast(text) {\n  return iziToast.show({\n    message: text,\n    messageSize: '16px',\n    messageWeight: '400',\n    backgroundColor: '#ef4040',\n    messageColor: '#fff',\n    position: 'topRight',\n    iconUrl: './img/error.svg',\n  });\n}\n\nlet page;\nlet maxPages;\nlet q;\n\nformEl.addEventListener('submit', async e => {\n  e.preventDefault();\n  btnLoad.classList.add('is-hidden');\n  gallery.innerHTML = '';\n\n  page = 1;\n  q = e.target.elements.picture.value.trim();\n  if (!q) {\n    e.target.reset();\n    showIziToast('The form field must be filled in!');\n    return;\n  }\n  loader.classList.remove('is-hidden');\n\n  try {\n    const data = await images.getImages(q, page);\n    maxPages = Math.ceil(data.totalHits / images.pageSize);\n    if (data.hits.length === 0) {\n      showIziToast(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    } else if (page >= maxPages) {\n      btnLoad.classList.add('is-hidden');\n      const galleryHtml = renderListGallery(data.hits);\n      gallery.innerHTML = galleryHtml;\n      showIziToast(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    } else {\n      const galleryHtml = renderListGallery(data.hits);\n      gallery.innerHTML = galleryHtml;\n      btnLoad.classList.remove('is-hidden');\n    }\n    show.refresh();\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loader.classList.add('is-hidden');\n    e.target.reset();\n  }\n});\n// ==================== button \"Load more\" =================================== //\nbtnLoad.addEventListener('click', addPictures);\n\nasync function addPictures(e) {\n  e.preventDefault();\n  btnLoad.classList.add('is-hidden');\n  loaderSecond.classList.remove('is-hidden');\n\n  page += 1;\n  try {\n    const data = await images.getImages(q, page);\n    maxPages = Math.ceil(data.totalHits / images.pageSize);\n    if (page >= maxPages) {\n      btnLoad.classList.add('is-hidden');\n      const galleryAddImages = renderListGallery(data.hits);\n      gallery.insertAdjacentHTML('beforeend', galleryAddImages);\n      showIziToast(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    } else {\n      const galleryAddImages = renderListGallery(data.hits);\n      gallery.insertAdjacentHTML('beforeend', galleryAddImages);\n\n      btnLoad.classList.remove('is-hidden');\n    }\n    const heidhtElem = gallery.firstElementChild.getBoundingClientRect().height;\n    window.scrollBy({\n      behavior: 'smooth',\n      top: heidhtElem * 2,\n    });\n    show.refresh();\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loaderSecond.classList.add('is-hidden');\n  }\n}\n"],"names":["ImageServer","__privateAdd","_pageSize","value","currentPage","params","__privateGet","url","axios","error","createGalleryMarkup","renderListGallery","images","el","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryMarkup","body","formEl","loader","loaderSecond","gallery","btnLoad","show","SimpleLightbox","showIziToast","text","iziToast","page","maxPages","q","e","data","galleryHtml","addPictures","galleryAddImages","heidhtElem"],"mappings":"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"}